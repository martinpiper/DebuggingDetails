; Demonstrates how the cycles jitter on a C64 because it's running at 1MHz and there are bad lines and sprite cycles...
; ..\c64\acme.exe --lib ../C64/ -v9 -f cbm -o c:\temp\t.prg C64CycleJitter.a && ..\c64\bin\LZMPi.exe -pp $37 -c64mbu c:\temp\t.prg c:\temp\t.prg $400 && c:\temp\t.prg

!source "stdlib/stdlib.a"

* = $400
	sei
	clc
	; Setup sprites to be visible
	lda #%11111111
	sta VIC2SpriteEnable
	; Sprites Y pos
	lda #100
!for .i , 4 {
	sta VIC2Sprite0Y + (.i-1)*2
	sta VIC2Sprite4Y + (.i-1)*2
	adc #21
}
	lda #VIC2Colour_Black
	ldx #VIC2Colour_White
!for .i , 4 {
	sta VIC2Sprite0Colour + (.i-1) * 2
	stx VIC2Sprite1Colour + (.i-1) * 2
}
	
	lda #0
!for .i , 4 {
	sta VIC2Sprite0X + (.i-1)*2
	adc #8
}
	lda #72
!for .i , 4 {
	sta VIC2Sprite4X + (.i-1)*2
	adc #8
}
	lda #%11110000
	sta VIC2SpriteXMSB
	
	; Show cycle jitter
.l1
	ldy #80
.l2
.wl1
	cpy VIC2Raster
	bne .wl1

	dec VIC2ScreenColour
	dec VIC2ScreenControlH
	inc VIC2ScreenColour
	inc VIC2ScreenControlH

	iny
	cpy #200
	bne .l2

	jmp .l1

	


!for .i , 40 {
	!scr "testing... "
}

; Sprite pointers, using the code as sprite frame data
* = $7f8
	!by 16,17,18,19,20,21,22,23
